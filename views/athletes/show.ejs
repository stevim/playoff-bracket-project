<%- include('../partials/html-head') %>
<link rel="stylesheet" href="/stylesheets/athletes/show.css" />
<%- include('../partials/nav') %>

<main>
  <h1>
    <%= title %>
  </h1>
</main>
<h2>Comments</h2>
<% if (athlete.comments.length) { %>
  <table>
    <tbody>
      <% athlete.comments.forEach(comment => { %>
        <tr>
          <td>"<%= comment.content %>"</td>
          <td>-<%= comment.creator.name %></td>
          <% if (comment.creator.equals(user?.profile._id)) { %>
            <td>-<%= comment.createdAt.toLocaleDateString() %></td>
            <td>
              <form action="/athletes/<%= athlete._id %>/comments/<%= comment._id %>?_method=DELETE" method="POST">
              <button>🗑️</button>
              </form>
            </td>
          <% } %>
        </tr>
      <% }) %>
      <tr>
        <td colspan="2"></td>
      </tr>
    </tbody>
  </table>
<% } %>
<% if (user) { %>
  <form id="add-ath-com-form" action="/athletes/<%= athlete._id %> comments" method="POST">
    <label for="content-textarea">Why are you a fan of <%= athlete.name %></label>
    <br>
    <textarea name="content" id="content-textarea"></textarea>
    <button type="submit">Add</button>
  </form>
<% } %>

<%- include('../partials/footer') %>